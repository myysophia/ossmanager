(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4530],{457:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(95155),r=a(12115),l=a(23006),n=a(7098),i=a(77700),c=a(75569),o=a(58670),d=a(58727),u=a(33636),h=a(4316),p=a(37824),x=a(83382),j=a(47272),f=a(76122),g=a(66080),m=a(24710),v=a(80436),y=a(59108),_=a(92622),b=a(16108),k=a(30044),T=a(47415);let N={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},w={horizontal:e=>({"& > *:not(style) ~ *:not(style)":{marginStart:e}}),vertical:e=>({"& > *:not(style) ~ *:not(style)":{marginTop:e}})},S=(0,k.R)(function(e,t){let{size:a,colorScheme:l,variant:n,className:i,spacing:c="0.5rem",isAttached:o,isDisabled:d,orientation:u="horizontal",...h}=e,p=(0,_.cx)("chakra-button__group",i),x=(0,r.useMemo)(()=>({size:a,colorScheme:l,variant:n,isDisabled:d}),[a,l,n,d]),j={display:"inline-flex",...o?N[u]:w[u](c)},f="vertical"===u;return(0,s.jsx)(b.l,{value:x,children:(0,s.jsx)(T.B.div,{ref:t,role:"group",__css:j,className:p,"data-attached":o?"":void 0,"data-orientation":u,flexDir:f?"column":void 0,...h})})});S.displayName="ButtonGroup";var B=a(77978);function R(e){let{currentPage:t,totalPages:a,onPageChange:r}=e;return(0,s.jsx)(y.s,{justify:"center",align:"center",mt:4,gap:4,children:(0,s.jsxs)(S,{size:"sm",variant:"outline",children:[(0,s.jsx)(B.$,{onClick:()=>r(t-1),isDisabled:1===t,children:"上一页"}),(0,s.jsxs)(B.$,{isDisabled:!0,children:[t," / ",a]}),(0,s.jsx)(B.$,{onClick:()=>r(t+1),isDisabled:t===a,children:"下一页"})]})})}function C(){let[e,t]=(0,r.useState)([]),[a,y]=(0,r.useState)(!1),[_,b]=(0,r.useState)(0),[k,T]=(0,r.useState)({keyword:"",action:"",resource:"",startDate:"",endDate:"",page:1,pageSize:10}),N=(0,l.d)();(0,n.dU)("white","gray.800"),(0,n.dU)("gray.200","gray.600"),(0,r.useEffect)(()=>{w()},[k]);let w=async()=>{y(!0);try{let e=await fetch("/api/admin/audit-logs?".concat(new URLSearchParams(k)));if(!e.ok)throw Error("获取审计日志失败");let a=await e.json();t(a.content),b(a.total)}catch(e){N({title:"获取审计日志失败",description:e instanceof Error?e.message:"未知错误",status:"error",duration:5e3,isClosable:!0})}finally{y(!1)}},S=(e,t)=>{T(a=>({...a,[e]:t.target.value,page:1}))},B=e=>{switch(e.toLowerCase()){case"create":return"green";case"update":return"blue";case"delete":return"red";case"login":return"purple";case"logout":return"orange";default:return"gray"}};return(0,s.jsx)(i.a,{p:6,children:(0,s.jsxs)(c.T,{spacing:6,align:"stretch",children:[(0,s.jsx)(o.E,{fontSize:"2xl",fontWeight:"bold",children:"审计日志"}),(0,s.jsxs)(d.z,{spacing:4,children:[(0,s.jsx)(u.p,{placeholder:"搜索关键词",value:k.keyword,onChange:e=>{T(t=>({...t,keyword:e.target.value,page:1}))},maxW:"300px"}),(0,s.jsxs)(h.l,{placeholder:"操作类型",value:k.action,onChange:e=>{T(t=>({...t,action:e.target.value,page:1}))},maxW:"200px",children:[(0,s.jsx)("option",{value:"create",children:"创建"}),(0,s.jsx)("option",{value:"update",children:"更新"}),(0,s.jsx)("option",{value:"delete",children:"删除"}),(0,s.jsx)("option",{value:"login",children:"登录"}),(0,s.jsx)("option",{value:"logout",children:"登出"})]}),(0,s.jsxs)(h.l,{placeholder:"资源类型",value:k.resource,onChange:e=>{T(t=>({...t,resource:e.target.value,page:1}))},maxW:"200px",children:[(0,s.jsx)("option",{value:"user",children:"用户"}),(0,s.jsx)("option",{value:"role",children:"角色"}),(0,s.jsx)("option",{value:"permission",children:"权限"}),(0,s.jsx)("option",{value:"file",children:"文件"}),(0,s.jsx)("option",{value:"config",children:"配置"})]}),(0,s.jsx)(u.p,{type:"date",value:k.startDate,onChange:e=>S("startDate",e),maxW:"200px"}),(0,s.jsx)(u.p,{type:"date",value:k.endDate,onChange:e=>S("endDate",e),maxW:"200px"})]}),(0,s.jsx)(i.a,{overflowX:"auto",children:(0,s.jsxs)(p.X,{variant:"simple",children:[(0,s.jsx)(x.d,{children:(0,s.jsxs)(j.Tr,{children:[(0,s.jsx)(f.Th,{children:"时间"}),(0,s.jsx)(f.Th,{children:"用户"}),(0,s.jsx)(f.Th,{children:"操作"}),(0,s.jsx)(f.Th,{children:"资源"}),(0,s.jsx)(f.Th,{children:"详情"}),(0,s.jsx)(f.Th,{children:"IP地址"})]})}),(0,s.jsx)(g.N,{children:e.map(e=>(0,s.jsxs)(j.Tr,{children:[(0,s.jsx)(m.Td,{children:new Date(e.createdAt).toLocaleString()}),(0,s.jsx)(m.Td,{children:e.username}),(0,s.jsx)(m.Td,{children:(0,s.jsx)(v.E,{colorScheme:B(e.action),children:e.action})}),(0,s.jsx)(m.Td,{children:e.resource}),(0,s.jsx)(m.Td,{children:e.details}),(0,s.jsx)(m.Td,{children:e.ip})]},e.id))})]})}),(0,s.jsx)(d.z,{justify:"center",children:(0,s.jsx)(R,{currentPage:k.page,totalPages:Math.ceil(_/k.pageSize),onPageChange:e=>{T(t=>({...t,page:e}))},showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>"共 ".concat(e," 条")})})]})})}},4316:(e,t,a)=>{"use strict";a.d(t,{l:()=>j});var s=a(95155),r=a(78038),l=a(97711),n=a(76783),i=a(73134),c=a(12115),o=a(92622),d=a(30044),u=a(47415);let h=(0,d.R)(function(e,t){let{children:a,placeholder:r,className:l,...n}=e;return(0,s.jsxs)(u.B.select,{...n,ref:t,className:(0,o.cx)("chakra-select",l),children:[r&&(0,s.jsx)("option",{value:"",children:r}),a]})});h.displayName="SelectField";var p=a(17248),x=a(17891);let j=(0,d.R)((e,t)=>{var a;let c=(0,x.o)("Select",e),{rootProps:o,placeholder:d,icon:j,color:f,height:g,h:v,minH:y,minHeight:_,iconColor:b,iconSize:k,...T}=(0,r.M)(e),[N,w]=(0,n.l)(T,l.GF),S=(0,p.t)(w),B={paddingEnd:"2rem",...c.field,_focus:{zIndex:"unset",...null===(a=c.field)||void 0===a?void 0:a._focus}};return(0,s.jsxs)(u.B.div,{className:"chakra-select__wrapper",__css:{width:"100%",height:"fit-content",position:"relative",color:f},...N,...o,children:[(0,s.jsx)(h,{ref:t,height:null!=v?v:g,minH:null!=y?y:_,placeholder:d,...S,__css:B,children:e.children}),(0,s.jsx)(m,{"data-disabled":(0,i.s)(S.disabled),...(b||f)&&{color:b||f},__css:c.icon,...k&&{fontSize:k},children:j})]})});j.displayName="Select";let f=e=>(0,s.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,s.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),g=(0,u.B)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),m=e=>{let{children:t=(0,s.jsx)(f,{}),...a}=e,r=(0,c.cloneElement)(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,s.jsx)(g,{...a,className:"chakra-select__icon-wrapper",children:(0,c.isValidElement)(t)?r:null})};m.displayName="SelectIcon"},24710:(e,t,a)=>{"use strict";a.d(t,{Td:()=>i});var s=a(95155),r=a(37824),l=a(30044),n=a(47415);let i=(0,l.R)((e,t)=>{let{isNumeric:a,...l}=e,i=(0,r.k)();return(0,s.jsx)(n.B.td,{...l,ref:t,__css:i.td,"data-is-numeric":a})})},33636:(e,t,a)=>{"use strict";a.d(t,{p:()=>d});var s=a(95155),r=a(78038),l=a(92622),n=a(17248),i=a(30044),c=a(17891),o=a(47415);let d=(0,i.R)(function(e,t){let{htmlSize:a,...i}=e,d=(0,c.o)("Input",i),u=(0,r.M)(i),h=(0,n.t)(u),p=(0,l.cx)("chakra-input",e.className);return(0,s.jsx)(o.B.input,{size:a,...h,__css:d.field,ref:t,className:p})});d.displayName="Input",d.id="Input"},37824:(e,t,a)=>{"use strict";a.d(t,{X:()=>h,k:()=>u});var s=a(95155),r=a(78038),l=a(61214),n=a(92622),i=a(30044),c=a(17891),o=a(47415);let[d,u]=(0,l.q)({name:"TableStylesContext",errorMessage:"useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Table />\" "}),h=(0,i.R)((e,t)=>{let a=(0,c.o)("Table",e),{className:l,layout:i,...u}=(0,r.M)(e);return(0,s.jsx)(d,{value:a,children:(0,s.jsx)(o.B.table,{ref:t,__css:{tableLayout:i,...a.table},className:(0,n.cx)("chakra-table",l),...u})})});h.displayName="Table"},44208:(e,t,a)=>{Promise.resolve().then(a.bind(a,457))},47272:(e,t,a)=>{"use strict";a.d(t,{Tr:()=>i});var s=a(95155),r=a(37824),l=a(30044),n=a(47415);let i=(0,l.R)((e,t)=>{let a=(0,r.k)();return(0,s.jsx)(n.B.tr,{...e,ref:t,__css:a.tr})})},58670:(e,t,a)=>{"use strict";a.d(t,{E:()=>d});var s=a(95155),r=a(78038),l=a(85720),n=a(92622),i=a(30044),c=a(17891),o=a(47415);let d=(0,i.R)(function(e,t){let a=(0,c.V)("Text",e),{className:i,align:d,decoration:u,casing:h,...p}=(0,r.M)(e),x=(0,l.o)({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return(0,s.jsx)(o.B.p,{ref:t,className:(0,n.cx)("chakra-text",e.className),...x,...p,__css:a})});d.displayName="Text"},58727:(e,t,a)=>{"use strict";a.d(t,{z:()=>l});var s=a(95155),r=a(60078);let l=(0,a(30044).R)((e,t)=>(0,s.jsx)(r.B,{align:"center",...e,direction:"row",ref:t}));l.displayName="HStack"},59108:(e,t,a)=>{"use strict";a.d(t,{s:()=>n});var s=a(95155),r=a(30044),l=a(47415);let n=(0,r.R)(function(e,t){let{direction:a,align:r,justify:n,wrap:i,basis:c,grow:o,shrink:d,...u}=e;return(0,s.jsx)(l.B.div,{ref:t,__css:{display:"flex",flexDirection:a,alignItems:r,justifyContent:n,flexWrap:i,flexBasis:c,flexGrow:o,flexShrink:d},...u})});n.displayName="Flex"},66080:(e,t,a)=>{"use strict";a.d(t,{N:()=>i});var s=a(95155),r=a(37824),l=a(30044),n=a(47415);let i=(0,l.R)((e,t)=>{let a=(0,r.k)();return(0,s.jsx)(n.B.tbody,{...e,ref:t,__css:a.tbody})})},75569:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var s=a(95155),r=a(60078);let l=(0,a(30044).R)((e,t)=>(0,s.jsx)(r.B,{align:"center",...e,direction:"column",ref:t}));l.displayName="VStack"},76122:(e,t,a)=>{"use strict";a.d(t,{Th:()=>i});var s=a(95155),r=a(37824),l=a(30044),n=a(47415);let i=(0,l.R)((e,t)=>{let{isNumeric:a,...l}=e,i=(0,r.k)();return(0,s.jsx)(n.B.th,{...l,ref:t,__css:i.th,"data-is-numeric":a})})},76783:(e,t,a)=>{"use strict";function s(e,t){let a={},s={};for(let[r,l]of Object.entries(e))t.includes(r)?a[r]=l:s[r]=l;return[a,s]}a.d(t,{l:()=>s})},80436:(e,t,a)=>{"use strict";a.d(t,{E:()=>o});var s=a(95155),r=a(78038),l=a(92622),n=a(30044),i=a(17891),c=a(47415);let o=(0,n.R)(function(e,t){let a=(0,i.V)("Badge",e),{className:n,...o}=(0,r.M)(e);return(0,s.jsx)(c.B.span,{ref:t,className:(0,l.cx)("chakra-badge",e.className),...o,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...a}})});o.displayName="Badge"},83382:(e,t,a)=>{"use strict";a.d(t,{d:()=>i});var s=a(95155),r=a(37824),l=a(30044),n=a(47415);let i=(0,l.R)((e,t)=>{let a=(0,r.k)();return(0,s.jsx)(n.B.thead,{...e,ref:t,__css:a.thead})})}},e=>{var t=t=>e(e.s=t);e.O(0,[8791,6829,6980,7039,2210,8441,1684,7358],()=>t(44208)),_N_E=e.O()}]);