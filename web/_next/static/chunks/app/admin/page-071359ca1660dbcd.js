(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{26584:(e,s,i)=>{"use strict";i.d(s,{S:()=>w});var r=i(95155),n=i(78038),t=i(72401),a=i(85720),l=i(92622),c=i(13380),o=i(12115);let[d,h]=(0,i(61214).q)({name:"CheckboxGroupContext",strict:!1});var x=i(47415);function j(e){return(0,r.jsx)(x.B.svg,{width:"1.2em",viewBox:"0 0 12 10",style:{fill:"none",strokeWidth:2,stroke:"currentColor",strokeDasharray:16},...e,children:(0,r.jsx)("polyline",{points:"1.5 6 4.5 9 10.5 1"})})}function u(e){return(0,r.jsx)(x.B.svg,{width:"1.2em",viewBox:"0 0 24 24",style:{stroke:"currentColor",strokeWidth:4},...e,children:(0,r.jsx)("line",{x1:"21",x2:"3",y1:"12",y2:"12"})})}function p(e){let{isIndeterminate:s,isChecked:i,...n}=e;return i||s?(0,r.jsx)(x.B.div,{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,r.jsx)(s?u:j,{...n})}):null}var m=i(1106),f=i(30044),g=i(17891);let v={display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",userSelect:"none",flexShrink:0},C={cursor:"pointer",display:"inline-flex",alignItems:"center",verticalAlign:"top",position:"relative"},y=(0,c.i7)({from:{opacity:0,strokeDashoffset:16,transform:"scale(0.95)"},to:{opacity:1,strokeDashoffset:0,transform:"scale(1)"}}),T=(0,c.i7)({from:{opacity:0},to:{opacity:1}}),k=(0,c.i7)({from:{transform:"scaleX(0.65)"},to:{transform:"scaleX(1)"}}),w=(0,f.R)(function(e,s){let i=h(),c={...i,...e},d=(0,g.o)("Checkbox",c),j=(0,n.M)(e),{spacing:u="0.5rem",className:f,children:w,iconColor:b,iconSize:S,icon:E=(0,r.jsx)(p,{}),isChecked:_,isDisabled:N=null==i?void 0:i.isDisabled,onChange:D,inputProps:I,...O}=j,J=_;(null==i?void 0:i.value)&&j.value&&(J=i.value.includes(j.value));let X=D;(null==i?void 0:i.onChange)&&j.value&&(X=(0,t.O)(i.onChange,D));let{state:B,getInputProps:M,getCheckboxProps:q,getLabelProps:R,getRootProps:W}=(0,m.v)({...O,isDisabled:N,isChecked:J,onChange:X}),z=function(e){let[s,i]=(0,o.useState)(e),[r,n]=(0,o.useState)(!1);return e!==s&&(n(!0),i(e)),r}(B.isChecked),$=(0,o.useMemo)(()=>({animation:z?B.isIndeterminate?"".concat(T," 20ms linear, ").concat(k," 200ms linear"):"".concat(y," 200ms linear"):void 0,...d.icon,...(0,a.o)({fontSize:S,color:b})}),[b,S,z,B.isIndeterminate,d.icon]),G=(0,o.cloneElement)(E,{__css:$,isIndeterminate:B.isIndeterminate,isChecked:B.isChecked});return(0,r.jsxs)(x.B.label,{__css:{...C,...d.container},className:(0,l.cx)("chakra-checkbox",f),...W(),children:[(0,r.jsx)("input",{className:"chakra-checkbox__input",...M(I,s)}),(0,r.jsx)(x.B.span,{__css:{...v,...d.control},className:"chakra-checkbox__control",...q(),children:G}),w&&(0,r.jsx)(x.B.span,{className:"chakra-checkbox__label",...R(),__css:{marginStart:u,...d.label},children:w})]})});w.displayName="Checkbox"},70826:(e,s,i)=>{Promise.resolve().then(i.bind(i,77220))},77220:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>G});var r=i(95155),n=i(12115),t=i(23006),a=i(52017),l=i(7098),c=i(77700),o=i(6126),d=i(40988),h=i(96065),x=i(62833),j=i(93176),u=i(75569),p=i(58727),m=i(58670),f=i(77978),g=i(37824),v=i(83382),C=i(47272),y=i(76122),T=i(66080),k=i(24710),w=i(80436),b=i(1996),S=i(831),E=i(39376),_=i(59771),N=i(82610),D=i(25442),I=i(64688),O=i(61549),J=i(27104),X=i(5643),B=i(26418),M=i(79175),q=i(33636),R=i(4316),W=i(49174),z=i(26584),$=i(10351);function G(){let[e,s]=(0,n.useState)([]),[i,G]=(0,n.useState)([]),[K,P]=(0,n.useState)([]),[U,Z]=(0,n.useState)(!1),[A,L]=(0,n.useState)(null),[F,H]=(0,n.useState)(null),[Q,V]=(0,n.useState)({username:"",email:"",password:"",role:"",status:"active"}),[Y,ee]=(0,n.useState)({name:"",description:"",permissions:[]}),es=(0,t.d)(),{isOpen:ei,onOpen:er,onClose:en}=(0,a.j)(),{isOpen:et,onOpen:ea,onClose:el}=(0,a.j)();(0,l.dU)("white","gray.800"),(0,l.dU)("gray.200","gray.600"),(0,n.useEffect)(()=>{ec(),eo(),ed()},[]);let ec=async()=>{Z(!0);try{let e=await fetch("/api/admin/users");if(!e.ok)throw Error("获取用户列表失败");let i=await e.json();s(i)}catch(e){es({title:"获取用户列表失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}finally{Z(!1)}},eo=async()=>{try{let e=await fetch("/api/admin/roles");if(!e.ok)throw Error("获取角色列表失败");let s=await e.json();G(s)}catch(e){es({title:"获取角色列表失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},ed=async()=>{try{let e=await fetch("/api/admin/permissions");if(!e.ok)throw Error("获取权限列表失败");let s=await e.json();P(s)}catch(e){es({title:"获取权限列表失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},eh=async()=>{try{if(!(await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)})).ok)throw Error("创建用户失败");ec(),en(),V({username:"",email:"",password:"",role:"",status:"active"}),es({title:"创建用户成功",status:"success",duration:3e3,isClosable:!0})}catch(e){es({title:"创建用户失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},ex=async()=>{if(A)try{if(!(await fetch("/api/admin/users/".concat(A.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)})).ok)throw Error("更新用户失败");ec(),en(),L(null),V({username:"",email:"",password:"",role:"",status:"active"}),es({title:"更新用户成功",status:"success",duration:3e3,isClosable:!0})}catch(e){es({title:"更新用户失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},ej=async e=>{try{if(!(await fetch("/api/admin/users/".concat(e),{method:"DELETE"})).ok)throw Error("删除用户失败");ec(),es({title:"删除用户成功",status:"success",duration:3e3,isClosable:!0})}catch(e){es({title:"删除用户失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},eu=async()=>{try{if(!(await fetch("/api/admin/roles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).ok)throw Error("创建角色失败");eo(),el(),ee({name:"",description:"",permissions:[]}),es({title:"创建角色成功",status:"success",duration:3e3,isClosable:!0})}catch(e){es({title:"创建角色失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},ep=async()=>{if(F)try{if(!(await fetch("/api/admin/roles/".concat(F.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).ok)throw Error("更新角色失败");eo(),el(),H(null),ee({name:"",description:"",permissions:[]}),es({title:"更新角色成功",status:"success",duration:3e3,isClosable:!0})}catch(e){es({title:"更新角色失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},em=async e=>{try{if(!(await fetch("/api/admin/roles/".concat(e),{method:"DELETE"})).ok)throw Error("删除角色失败");eo(),es({title:"删除角色成功",status:"success",duration:3e3,isClosable:!0})}catch(e){es({title:"删除角色失败",description:e.message,status:"error",duration:5e3,isClosable:!0})}},ef=e=>{L(e),V({username:e.username,email:e.email,password:"",role:e.role,status:e.status}),er()},eg=e=>{H(e),ee({name:e.name,description:e.description,permissions:e.permissions}),ea()};return(0,r.jsxs)(c.a,{p:6,children:[(0,r.jsxs)(o.t,{children:[(0,r.jsxs)(d.w,{children:[(0,r.jsx)(h.o,{children:"用户管理"}),(0,r.jsx)(h.o,{children:"角色管理"}),(0,r.jsx)(h.o,{children:"权限管理"})]}),(0,r.jsxs)(x.T,{children:[(0,r.jsx)(j.K,{children:(0,r.jsxs)(u.T,{spacing:6,align:"stretch",children:[(0,r.jsxs)(p.z,{justify:"space-between",children:[(0,r.jsx)(m.E,{fontSize:"2xl",fontWeight:"bold",children:"用户列表"}),(0,r.jsx)(f.$,{leftIcon:(0,r.jsx)($.GGD,{}),onClick:()=>{L(null),V({username:"",email:"",password:"",role:"",status:"active"}),er()},children:"新建用户"})]}),(0,r.jsx)(c.a,{overflowX:"auto",children:(0,r.jsxs)(g.X,{variant:"simple",children:[(0,r.jsx)(v.d,{children:(0,r.jsxs)(C.Tr,{children:[(0,r.jsx)(y.Th,{children:"用户名"}),(0,r.jsx)(y.Th,{children:"邮箱"}),(0,r.jsx)(y.Th,{children:"角色"}),(0,r.jsx)(y.Th,{children:"状态"}),(0,r.jsx)(y.Th,{children:"创建时间"}),(0,r.jsx)(y.Th,{children:"操作"})]})}),(0,r.jsx)(T.N,{children:e.map(e=>(0,r.jsxs)(C.Tr,{children:[(0,r.jsx)(k.Td,{children:e.username}),(0,r.jsx)(k.Td,{children:e.email}),(0,r.jsx)(k.Td,{children:e.role}),(0,r.jsx)(k.Td,{children:(0,r.jsx)(w.E,{colorScheme:"active"===e.status?"green":"red",children:"active"===e.status?"启用":"禁用"})}),(0,r.jsx)(k.Td,{children:new Date(e.createdAt).toLocaleString()}),(0,r.jsx)(k.Td,{children:(0,r.jsxs)(b.W,{children:[(0,r.jsx)(S.I,{as:E.K,icon:(0,r.jsx)($.ZZB,{}),variant:"ghost",size:"sm"}),(0,r.jsxs)(_.c,{children:[(0,r.jsx)(N.D,{icon:(0,r.jsx)($.WXf,{}),onClick:()=>ef(e),children:"编辑"}),(0,r.jsx)(N.D,{icon:(0,r.jsx)($.IXo,{}),onClick:()=>ej(e.id),color:"red.500",children:"删除"})]})]})})]},e.id))})]})})]})}),(0,r.jsx)(j.K,{children:(0,r.jsxs)(u.T,{spacing:6,align:"stretch",children:[(0,r.jsxs)(p.z,{justify:"space-between",children:[(0,r.jsx)(m.E,{fontSize:"2xl",fontWeight:"bold",children:"角色列表"}),(0,r.jsx)(f.$,{leftIcon:(0,r.jsx)($.GGD,{}),onClick:()=>{H(null),ee({name:"",description:"",permissions:[]}),ea()},children:"新建角色"})]}),(0,r.jsx)(c.a,{overflowX:"auto",children:(0,r.jsxs)(g.X,{variant:"simple",children:[(0,r.jsx)(v.d,{children:(0,r.jsxs)(C.Tr,{children:[(0,r.jsx)(y.Th,{children:"角色名称"}),(0,r.jsx)(y.Th,{children:"描述"}),(0,r.jsx)(y.Th,{children:"权限数量"}),(0,r.jsx)(y.Th,{children:"操作"})]})}),(0,r.jsx)(T.N,{children:i.map(e=>(0,r.jsxs)(C.Tr,{children:[(0,r.jsx)(k.Td,{children:e.name}),(0,r.jsx)(k.Td,{children:e.description}),(0,r.jsx)(k.Td,{children:e.permissions.length}),(0,r.jsx)(k.Td,{children:(0,r.jsxs)(b.W,{children:[(0,r.jsx)(S.I,{as:E.K,icon:(0,r.jsx)($.ZZB,{}),variant:"ghost",size:"sm"}),(0,r.jsxs)(_.c,{children:[(0,r.jsx)(N.D,{icon:(0,r.jsx)($.WXf,{}),onClick:()=>eg(e),children:"编辑"}),(0,r.jsx)(N.D,{icon:(0,r.jsx)($.IXo,{}),onClick:()=>em(e.id),color:"red.500",children:"删除"})]})]})})]},e.id))})]})})]})}),(0,r.jsx)(j.K,{children:(0,r.jsxs)(u.T,{spacing:6,align:"stretch",children:[(0,r.jsx)(m.E,{fontSize:"2xl",fontWeight:"bold",children:"权限列表"}),(0,r.jsx)(c.a,{overflowX:"auto",children:(0,r.jsxs)(g.X,{variant:"simple",children:[(0,r.jsx)(v.d,{children:(0,r.jsxs)(C.Tr,{children:[(0,r.jsx)(y.Th,{children:"权限名称"}),(0,r.jsx)(y.Th,{children:"描述"}),(0,r.jsx)(y.Th,{children:"模块"})]})}),(0,r.jsx)(T.N,{children:K.map(e=>(0,r.jsxs)(C.Tr,{children:[(0,r.jsx)(k.Td,{children:e.name}),(0,r.jsx)(k.Td,{children:e.description}),(0,r.jsx)(k.Td,{children:e.module})]},e.id))})]})})]})})]})]}),(0,r.jsxs)(D.aF,{isOpen:ei,onClose:en,children:[(0,r.jsx)(I.m,{}),(0,r.jsxs)(O.$,{children:[(0,r.jsx)(J.r,{children:A?"编辑用户":"新建用户"}),(0,r.jsx)(X.c,{children:(0,r.jsxs)(u.T,{spacing:4,children:[(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"用户名"}),(0,r.jsx)(q.p,{value:Q.username,onChange:e=>V(s=>({...s,username:e.target.value})),placeholder:"请输入用户名"})]}),(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"邮箱"}),(0,r.jsx)(q.p,{type:"email",value:Q.email,onChange:e=>V(s=>({...s,email:e.target.value})),placeholder:"请输入邮箱"})]}),!A&&(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"密码"}),(0,r.jsx)(q.p,{type:"password",value:Q.password,onChange:e=>V(s=>({...s,password:e.target.value})),placeholder:"请输入密码"})]}),(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"角色"}),(0,r.jsx)(R.l,{value:Q.role,onChange:e=>V(s=>({...s,role:e.target.value})),children:i.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))})]}),(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"状态"}),(0,r.jsxs)(R.l,{value:Q.status,onChange:e=>V(s=>({...s,status:e.target.value})),children:[(0,r.jsx)("option",{value:"active",children:"启用"}),(0,r.jsx)("option",{value:"inactive",children:"禁用"})]})]})]})}),(0,r.jsxs)(W.j,{children:[(0,r.jsx)(f.$,{variant:"ghost",mr:3,onClick:en,children:"取消"}),(0,r.jsx)(f.$,{colorScheme:"blue",onClick:A?ex:eh,children:A?"更新":"创建"})]})]})]}),(0,r.jsxs)(D.aF,{isOpen:et,onClose:el,children:[(0,r.jsx)(I.m,{}),(0,r.jsxs)(O.$,{children:[(0,r.jsx)(J.r,{children:F?"编辑角色":"新建角色"}),(0,r.jsx)(X.c,{children:(0,r.jsxs)(u.T,{spacing:4,children:[(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"角色名称"}),(0,r.jsx)(q.p,{value:Y.name,onChange:e=>ee(s=>({...s,name:e.target.value})),placeholder:"请输入角色名称"})]}),(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"描述"}),(0,r.jsx)(q.p,{value:Y.description,onChange:e=>ee(s=>({...s,description:e.target.value})),placeholder:"请输入角色描述"})]}),(0,r.jsxs)(B.MJ,{isRequired:!0,children:[(0,r.jsx)(M.l,{children:"权限"}),(0,r.jsx)(u.T,{align:"start",spacing:2,children:K.map(e=>(0,r.jsx)(z.S,{isChecked:Y.permissions.includes(e.id),onChange:s=>{s.target.checked?ee(s=>({...s,permissions:[...s.permissions,e.id]})):ee(s=>({...s,permissions:s.permissions.filter(s=>s!==e.id)}))},children:e.name},e.id))})]})]})}),(0,r.jsxs)(W.j,{children:[(0,r.jsx)(f.$,{variant:"ghost",mr:3,onClick:el,children:"取消"}),(0,r.jsx)(f.$,{colorScheme:"blue",onClick:F?ep:eu,children:F?"更新":"创建"})]})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[844,8791,6829,6980,7039,2210,3513,8277,6654,8815,4415,8441,1684,7358],()=>s(70826)),_N_E=e.O()}]);