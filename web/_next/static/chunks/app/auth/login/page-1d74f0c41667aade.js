(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4859],{4177:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var a=r(95155),s=r(12115),o=r(77700),n=r(23006),l=r(59108),i=r(7098),c=r(60525),u=r(58670),d=r(11649),h=r(60078),m=r(26418),p=r(79175),g=r(33636),x=r(26584),f=r(77978),b=r(35695),v=r(1978),y=r(22370);let j=(0,v.P)(o.a),k=(0,v.P)(o.a);function S(){return Math.random().toString().slice(2,6)}function _(){let[e,t]=(0,s.useState)(""),[r,_]=(0,s.useState)(""),[w,C]=(0,s.useState)(!1),[I,R]=(0,s.useState)(!1),[N,B]=(0,s.useState)(S()),[P,E]=(0,s.useState)(""),[A,z]=(0,s.useState)(""),D=(0,b.useRouter)(),U=(0,n.d)(),L=()=>{B(S()),E(""),z("")},O=async t=>{if(t.preventDefault(),z(""),P!==N){z("验证码错误"),L();return}C(!0);try{await y.p.login({username:e,password:r})&&(U({title:"登录成功",status:"success",duration:3e3,isClosable:!0}),D.push("/main/dashboard"))}catch(e){U({title:"登录失败",description:e instanceof Error?e.message:"未知错误",status:"error",duration:3e3,isClosable:!0})}finally{C(!1)}};return(0,a.jsxs)(l.s,{minH:"100vh",direction:{base:"column",md:"row"},children:[(0,a.jsxs)(o.a,{flex:"1",bg:(0,i.dU)("blue.700","blue.900"),color:"white",position:"relative",overflow:"hidden",children:[(0,a.jsxs)(o.a,{position:"absolute",top:"4",left:"4",display:"flex",alignItems:"center",zIndex:"1",children:[(0,a.jsx)(c._,{src:"/logo.svg",alt:"OSS Management System",height:"40px",mr:3}),(0,a.jsx)(u.E,{fontSize:"xl",fontWeight:"bold",children:"OSS Manager"})]}),(0,a.jsx)(o.a,{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",opacity:"0.1",bgImage:"url('/pattern.svg')",bgRepeat:"repeat"}),(0,a.jsxs)(l.s,{height:"100%",direction:"column",alignItems:"center",justifyContent:"center",position:"relative",p:8,textAlign:"center",children:[(0,a.jsxs)(o.a,{mb:8,maxW:"480px",children:[(0,a.jsx)(d.D,{as:"h1",size:"2xl",mb:4,bgGradient:"linear(to-r, white, blue.200)",bgClip:"text",children:"OSS 文件管理系统"}),(0,a.jsx)(u.E,{fontSize:"lg",color:"blue.100",maxW:"400px",mx:"auto",children:"一个高效的oss文件管理的Web工具"})]}),(0,a.jsx)(k,{position:"relative",w:"full",maxW:"600px",initial:{y:0},animate:{y:[0,-10,0],transition:{duration:4,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}},style:{perspective:"1000px",transformStyle:"preserve-3d"},children:(0,a.jsx)(o.a,{position:"relative",transform:"translateZ(0)",_before:{content:'""',position:"absolute",bottom:"-20px",left:"50%",transform:"translateX(-50%)",width:"70%",height:"20px",background:"rgba(0, 0, 0, 0.1)",filter:"blur(10px)",borderRadius:"50%",animation:"shadowPulse 4s ease-in-out infinite"},sx:{"@keyframes shadowPulse":{"0%, 100%":{transform:"translateX(-50%) scale(1)",opacity:.3},"50%":{transform:"translateX(-50%) scale(0.9)",opacity:.2}}},children:(0,a.jsx)(c._,{src:"/login-illustration.svg",alt:"System Illustration",w:"full",h:"auto",style:{transform:"translateZ(20px)",transformStyle:"preserve-3d"}})})}),(0,a.jsx)(o.a,{position:"absolute",top:"20%",left:"15%",as:v.P.div,animate:{y:[0,-15,0],transition:{duration:3,repeat:1/0,repeatType:"reverse",ease:"easeInOut",delay:.5}},children:(0,a.jsx)(o.a,{w:"10px",h:"10px",bg:"blue.200",borderRadius:"full",opacity:.6})}),(0,a.jsx)(o.a,{position:"absolute",bottom:"25%",right:"15%",as:v.P.div,animate:{y:[0,-20,0],transition:{duration:3.5,repeat:1/0,repeatType:"reverse",ease:"easeInOut",delay:1}},children:(0,a.jsx)(o.a,{w:"8px",h:"8px",bg:"green.300",borderRadius:"full",opacity:.6})})]}),(0,a.jsx)(o.a,{position:"absolute",bottom:"0",left:"0",right:"0",height:"200px",bgGradient:"linear(to-t, blue.800, transparent)",pointerEvents:"none"})]}),(0,a.jsx)(l.s,{flex:"1",align:"center",justify:"center",bg:(0,i.dU)("gray.50","gray.900"),p:8,children:(0,a.jsx)(j,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},w:"full",maxW:"md",p:8,borderRadius:"xl",bg:(0,i.dU)("white","gray.800"),boxShadow:"xl",children:(0,a.jsxs)(h.B,{spacing:6,children:[(0,a.jsx)(h.B,{spacing:2,children:(0,a.jsx)(d.D,{size:"lg",children:"欢迎回来 \uD83D\uDC4B\uD83C\uDFFB"})}),(0,a.jsx)("form",{onSubmit:O,children:(0,a.jsxs)(h.B,{spacing:5,children:[(0,a.jsxs)(m.MJ,{isRequired:!0,children:[(0,a.jsx)(p.l,{children:"用户名"}),(0,a.jsx)(g.p,{type:"text",placeholder:"请输入您的用户名",value:e,onChange:e=>t(e.target.value),size:"lg",borderRadius:"md"})]}),(0,a.jsxs)(m.MJ,{isRequired:!0,children:[(0,a.jsx)(p.l,{children:"密码"}),(0,a.jsx)(g.p,{type:"password",placeholder:"请输入您的密码",value:r,onChange:e=>_(e.target.value),size:"lg",borderRadius:"md"})]}),(0,a.jsxs)(m.MJ,{isRequired:!0,children:[(0,a.jsx)(p.l,{children:"验证码"}),(0,a.jsxs)(l.s,{align:"center",children:[(0,a.jsx)(g.p,{type:"text",placeholder:"请输入验证码",value:P,onChange:e=>E(e.target.value),size:"lg",borderRadius:"md",maxLength:4}),(0,a.jsx)(o.a,{ml:3,px:3,py:2,bg:(0,i.dU)("gray.200","gray.600"),borderRadius:"md",fontWeight:"bold",fontSize:"lg",letterSpacing:"4px",cursor:"pointer",userSelect:"none",onClick:L,title:"点击刷新验证码",children:N})]}),A&&(0,a.jsx)(u.E,{color:"red.500",fontSize:"sm",mt:1,children:A})]}),(0,a.jsxs)(h.B,{spacing:5,children:[(0,a.jsx)(l.s,{justify:"space-between",align:"center",children:(0,a.jsx)(x.S,{isChecked:I,onChange:e=>R(e.target.checked),colorScheme:"blue",children:"记住我"})}),(0,a.jsx)(f.$,{type:"submit",colorScheme:"blue",size:"lg",fontSize:"md",isLoading:w,_hover:{transform:"translateY(-2px)",boxShadow:"lg"},_active:{transform:"translateY(0)",boxShadow:"md"},children:"登录"})]})]})})]})})})]})}},7161:(e,t,r)=>{"use strict";r.d(t,{HY:()=>s,Hl:()=>a});let a=()=>{console.log("\uD83D\uDD10 认证令牌过期，清除认证信息并重定向到登录页..."),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("refreshToken"),document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",window.location.pathname.includes("/auth/login")||(window.location.href="/auth/login")},s=e=>{var t;return e&&"object"==typeof e&&"response"in e&&(null===(t=e.response)||void 0===t?void 0:t.status)===401}},11649:(e,t,r)=>{"use strict";r.d(t,{D:()=>c});var a=r(95155),s=r(78038),o=r(92622),n=r(30044),l=r(17891),i=r(47415);let c=(0,n.R)(function(e,t){let r=(0,l.V)("Heading",e),{className:n,...c}=(0,s.M)(e);return(0,a.jsx)(i.B.h2,{ref:t,className:(0,o.cx)("chakra-heading",e.className),...c,__css:r})});c.displayName="Heading"},22370:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var a=r(96918),s=r(7161);let o={login:async e=>{try{let t=await a.A.post("/auth/login",e);if(console.log("登录响应数据:",t),!t.data||"object"!=typeof t.data)throw console.error("响应数据格式错误:",t),Error("响应数据格式错误");let r=t.data,s=r.data||r;if(!s.token||!s.user)throw console.error("缺少token或user数据:",r),Error("认证响应缺少必要数据");let{token:o,user:n}=s;return localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(n)),document.cookie="token=".concat(o,"; path=/; ").concat("secure;"," samesite=strict; max-age=86400"),s}catch(e){if(console.error("登录失败:",e),e.message)throw e;throw Error("登录失败，请检查用户名和密码")}},register:async e=>{await a.A.post("/auth/register",e)},getCurrentUser:async()=>(await a.A.get("/user/current")).data.data,logout:async()=>{try{await a.A.post("/auth/logout")}catch(e){console.warn("服务器登出请求失败，但仍会清除本地认证信息:",e)}(0,s.Hl)()},isAuthenticated:()=>!!localStorage.getItem("token"),getStoredUser:()=>{let e=localStorage.getItem("user");if(e)try{return JSON.parse(e)}catch(e){console.error("解析用户信息失败",e)}return null}}},26584:(e,t,r)=>{"use strict";r.d(t,{S:()=>_});var a=r(95155),s=r(78038),o=r(72401),n=r(85720),l=r(92622),i=r(13380),c=r(12115);let[u,d]=(0,r(61214).q)({name:"CheckboxGroupContext",strict:!1});var h=r(47415);function m(e){return(0,a.jsx)(h.B.svg,{width:"1.2em",viewBox:"0 0 12 10",style:{fill:"none",strokeWidth:2,stroke:"currentColor",strokeDasharray:16},...e,children:(0,a.jsx)("polyline",{points:"1.5 6 4.5 9 10.5 1"})})}function p(e){return(0,a.jsx)(h.B.svg,{width:"1.2em",viewBox:"0 0 24 24",style:{stroke:"currentColor",strokeWidth:4},...e,children:(0,a.jsx)("line",{x1:"21",x2:"3",y1:"12",y2:"12"})})}function g(e){let{isIndeterminate:t,isChecked:r,...s}=e;return r||t?(0,a.jsx)(h.B.div,{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,a.jsx)(t?p:m,{...s})}):null}var x=r(1106),f=r(30044),b=r(17891);let v={display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",userSelect:"none",flexShrink:0},y={cursor:"pointer",display:"inline-flex",alignItems:"center",verticalAlign:"top",position:"relative"},j=(0,i.i7)({from:{opacity:0,strokeDashoffset:16,transform:"scale(0.95)"},to:{opacity:1,strokeDashoffset:0,transform:"scale(1)"}}),k=(0,i.i7)({from:{opacity:0},to:{opacity:1}}),S=(0,i.i7)({from:{transform:"scaleX(0.65)"},to:{transform:"scaleX(1)"}}),_=(0,f.R)(function(e,t){let r=d(),i={...r,...e},u=(0,b.o)("Checkbox",i),m=(0,s.M)(e),{spacing:p="0.5rem",className:f,children:_,iconColor:w,iconSize:C,icon:I=(0,a.jsx)(g,{}),isChecked:R,isDisabled:N=null==r?void 0:r.isDisabled,onChange:B,inputProps:P,...E}=m,A=R;(null==r?void 0:r.value)&&m.value&&(A=r.value.includes(m.value));let z=B;(null==r?void 0:r.onChange)&&m.value&&(z=(0,o.O)(r.onChange,B));let{state:D,getInputProps:U,getCheckboxProps:L,getLabelProps:O,getRootProps:q}=(0,x.v)({...E,isDisabled:N,isChecked:A,onChange:z}),M=function(e){let[t,r]=(0,c.useState)(e),[a,s]=(0,c.useState)(!1);return e!==t&&(s(!0),r(e)),a}(D.isChecked),T=(0,c.useMemo)(()=>({animation:M?D.isIndeterminate?"".concat(k," 20ms linear, ").concat(S," 200ms linear"):"".concat(j," 200ms linear"):void 0,...u.icon,...(0,n.o)({fontSize:C,color:w})}),[w,C,M,D.isIndeterminate,u.icon]),W=(0,c.cloneElement)(I,{__css:T,isIndeterminate:D.isIndeterminate,isChecked:D.isChecked});return(0,a.jsxs)(h.B.label,{__css:{...y,...u.container},className:(0,l.cx)("chakra-checkbox",f),...q(),children:[(0,a.jsx)("input",{className:"chakra-checkbox__input",...U(P,t)}),(0,a.jsx)(h.B.span,{__css:{...v,...u.control},className:"chakra-checkbox__control",...L(),children:W}),_&&(0,a.jsx)(h.B.span,{className:"chakra-checkbox__label",...O(),__css:{marginStart:p,...u.label},children:_})]})});_.displayName="Checkbox"},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},41890:(e,t,r)=>{"use strict";r.d(t,{l:()=>o,m:()=>n});var a=r(87874),s=r(12115);function o(e){let{loading:t,src:r,srcSet:o,onLoad:n,onError:l,crossOrigin:i,sizes:c,ignoreFallback:u}=e,[d,h]=(0,s.useState)("pending");(0,s.useEffect)(()=>{h(r?"loading":"pending")},[r]);let m=(0,s.useRef)(null),p=(0,s.useCallback)(()=>{if(!r)return;g();let e=new Image;e.src=r,i&&(e.crossOrigin=i),o&&(e.srcset=o),c&&(e.sizes=c),t&&(e.loading=t),e.onload=e=>{g(),h("loaded"),null==n||n(e)},e.onerror=e=>{g(),h("failed"),null==l||l(e)},m.current=e},[r,i,o,c,n,l,t]),g=()=>{m.current&&(m.current.onload=null,m.current.onerror=null,m.current=null)};return(0,a.U)(()=>{if(!u)return"loading"===d&&p(),()=>{g()}},[d,p,u]),u?"loaded":d}let n=(e,t)=>"loaded"!==e&&"beforeLoadOrError"===t||"failed"===e&&"onError"===t},58670:(e,t,r)=>{"use strict";r.d(t,{E:()=>u});var a=r(95155),s=r(78038),o=r(85720),n=r(92622),l=r(30044),i=r(17891),c=r(47415);let u=(0,l.R)(function(e,t){let r=(0,i.V)("Text",e),{className:l,align:u,decoration:d,casing:h,...m}=(0,s.M)(e),p=(0,o.o)({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return(0,a.jsx)(c.B.p,{ref:t,className:(0,n.cx)("chakra-text",e.className),...p,...m,__css:r})});u.displayName="Text"},59108:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var a=r(95155),s=r(30044),o=r(47415);let n=(0,s.R)(function(e,t){let{direction:r,align:s,justify:n,wrap:l,basis:i,grow:c,shrink:u,...d}=e;return(0,a.jsx)(o.B.div,{ref:t,__css:{display:"flex",flexDirection:r,alignItems:s,justifyContent:n,flexWrap:l,flexBasis:i,flexGrow:c,flexShrink:u},...d})});n.displayName="Flex"},60525:(e,t,r)=>{"use strict";r.d(t,{_:()=>c});var a=r(95155),s=r(3304),o=r(30044);let n=(0,o.R)(function(e,t){let{htmlWidth:r,htmlHeight:s,alt:o,...n}=e;return(0,a.jsx)("img",{width:r,height:s,ref:t,alt:o,...n})});n.displayName="NativeImage";var l=r(41890),i=r(47415);let c=(0,o.R)(function(e,t){let{fallbackSrc:r,fallback:o,src:c,srcSet:u,align:d,fit:h,loading:m,ignoreFallback:p,crossOrigin:g,fallbackStrategy:x="beforeLoadOrError",referrerPolicy:f,...b}=e,v=void 0!==r||void 0!==o,y=null!=m||p||!v,j=(0,l.l)({...e,crossOrigin:g,ignoreFallback:y}),k=(0,l.m)(j,x),S={ref:t,objectFit:h,objectPosition:d,...y?b:(0,s.c)(b,["onError","onLoad"])};return k?o||(0,a.jsx)(i.B.img,{as:n,className:"chakra-image__placeholder",src:r,...S}):(0,a.jsx)(i.B.img,{as:n,src:c,srcSet:u,crossOrigin:g,loading:m,referrerPolicy:f,className:"chakra-image",...S})});c.displayName="Image"},79175:(e,t,r)=>{"use strict";r.d(t,{l:()=>u});var a=r(95155),s=r(78038),o=r(92622),n=r(26418),l=r(30044),i=r(17891),c=r(47415);let u=(0,l.R)(function(e,t){var r;let l=(0,i.V)("FormLabel",e),u=(0,s.M)(e),{className:h,children:m,requiredIndicator:p=(0,a.jsx)(d,{}),optionalIndicator:g=null,...x}=u,f=(0,n.Uc)(),b=null!==(r=null==f?void 0:f.getLabelProps(x,t))&&void 0!==r?r:{ref:t,...x};return(0,a.jsxs)(c.B.label,{...b,className:(0,o.cx)("chakra-form__label",u.className),__css:{display:"block",textAlign:"start",...l},children:[m,(null==f?void 0:f.isRequired)?p:g]})});u.displayName="FormLabel";let d=(0,l.R)(function(e,t){let r=(0,n.Uc)(),s=(0,n.TP)();if(!(null==r?void 0:r.isRequired))return null;let l=(0,o.cx)("chakra-form__required-indicator",e.className);return(0,a.jsx)(c.B.span,{...null==r?void 0:r.getRequiredIndicatorProps(e,t),__css:s.requiredIndicator,className:l})});d.displayName="RequiredIndicator"},96918:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(23464),s=r(7161),o=r(49509);let n=a.A.create({baseURL:o.env.NEXT_PUBLIC_API_URL||"http://localhost:8081/api/v1",timeout:36e5,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return console.log("发送请求:",{url:e.url,method:e.method,baseURL:e.baseURL,headers:e.headers,fullPath:"".concat(e.baseURL).concat(e.url)}),e},e=>(console.error("请求拦截器错误:",e),Promise.reject(e))),n.interceptors.response.use(e=>{console.log("收到响应:",{url:e.config.url,status:e.status,data:e.data});let t=e.data;return t&&"object"==typeof t&&void 0!==t.code?0!==t.code&&200!==t.code?(console.error("API响应错误:",t),Promise.reject(Error(t.message||"请求失败"))):t:e},e=>{var t,r,a;return console.error("请求失败:",{url:null===(t=e.config)||void 0===t?void 0:t.url,message:e.message,response:null===(r=e.response)||void 0===r?void 0:r.data}),e.response?401===e.response.status?(0,s.Hl)():console.error("API错误:",(null===(a=e.response.data)||void 0===a?void 0:a.message)||"请求失败"):e.request?console.error("网络错误: 请检查网络连接"):console.error("请求错误:",e.message||"发生未知错误"),Promise.reject(e)});let l=n},99967:(e,t,r)=>{Promise.resolve().then(r.bind(r,4177))}},e=>{var t=t=>e(e.s=t);e.O(0,[8791,6829,6980,7039,2210,3464,8277,8441,1684,7358],()=>t(99967)),_N_E=e.O()}]);