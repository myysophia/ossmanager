(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9638],{4316:(e,t,s)=>{"use strict";s.d(t,{l:()=>m});var r=s(95155),i=s(78038),n=s(97711),a=s(76783),l=s(73134),c=s(12115),o=s(92622),d=s(30044),u=s(47415);let h=(0,d.R)(function(e,t){let{children:s,placeholder:i,className:n,...a}=e;return(0,r.jsxs)(u.B.select,{...a,ref:t,className:(0,o.cx)("chakra-select",n),children:[i&&(0,r.jsx)("option",{value:"",children:i}),s]})});h.displayName="SelectField";var x=s(17248),p=s(17891);let m=(0,d.R)((e,t)=>{var s;let c=(0,p.o)("Select",e),{rootProps:o,placeholder:d,icon:m,color:f,height:j,h:v,minH:y,minHeight:g,iconColor:k,iconSize:C,..._}=(0,i.M)(e),[w,T]=(0,a.l)(_,n.GF),E=(0,x.t)(T),S={paddingEnd:"2rem",...c.field,_focus:{zIndex:"unset",...null===(s=c.field)||void 0===s?void 0:s._focus}};return(0,r.jsxs)(u.B.div,{className:"chakra-select__wrapper",__css:{width:"100%",height:"fit-content",position:"relative",color:f},...w,...o,children:[(0,r.jsx)(h,{ref:t,height:null!=v?v:j,minH:null!=y?y:g,placeholder:d,...E,__css:S,children:e.children}),(0,r.jsx)(b,{"data-disabled":(0,l.s)(E.disabled),...(k||f)&&{color:k||f},__css:c.icon,...C&&{fontSize:C},children:m})]})});m.displayName="Select";let f=e=>(0,r.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,r.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),j=(0,u.B)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),b=e=>{let{children:t=(0,r.jsx)(f,{}),...s}=e,i=(0,c.cloneElement)(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,r.jsx)(j,{...s,className:"chakra-select__icon-wrapper",children:(0,c.isValidElement)(t)?i:null})};b.displayName="SelectIcon"},12210:(e,t,s)=>{Promise.resolve().then(s.bind(s,92424))},24710:(e,t,s)=>{"use strict";s.d(t,{Td:()=>l});var r=s(95155),i=s(37824),n=s(30044),a=s(47415);let l=(0,n.R)((e,t)=>{let{isNumeric:s,...n}=e,l=(0,i.k)();return(0,r.jsx)(a.B.td,{...n,ref:t,__css:l.td,"data-is-numeric":s})})},26584:(e,t,s)=>{"use strict";s.d(t,{S:()=>_});var r=s(95155),i=s(78038),n=s(72401),a=s(85720),l=s(92622),c=s(13380),o=s(12115);let[d,u]=(0,s(61214).q)({name:"CheckboxGroupContext",strict:!1});var h=s(47415);function x(e){return(0,r.jsx)(h.B.svg,{width:"1.2em",viewBox:"0 0 12 10",style:{fill:"none",strokeWidth:2,stroke:"currentColor",strokeDasharray:16},...e,children:(0,r.jsx)("polyline",{points:"1.5 6 4.5 9 10.5 1"})})}function p(e){return(0,r.jsx)(h.B.svg,{width:"1.2em",viewBox:"0 0 24 24",style:{stroke:"currentColor",strokeWidth:4},...e,children:(0,r.jsx)("line",{x1:"21",x2:"3",y1:"12",y2:"12"})})}function m(e){let{isIndeterminate:t,isChecked:s,...i}=e;return s||t?(0,r.jsx)(h.B.div,{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,r.jsx)(t?p:x,{...i})}):null}var f=s(1106),j=s(30044),b=s(17891);let v={display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",userSelect:"none",flexShrink:0},y={cursor:"pointer",display:"inline-flex",alignItems:"center",verticalAlign:"top",position:"relative"},g=(0,c.i7)({from:{opacity:0,strokeDashoffset:16,transform:"scale(0.95)"},to:{opacity:1,strokeDashoffset:0,transform:"scale(1)"}}),k=(0,c.i7)({from:{opacity:0},to:{opacity:1}}),C=(0,c.i7)({from:{transform:"scaleX(0.65)"},to:{transform:"scaleX(1)"}}),_=(0,j.R)(function(e,t){let s=u(),c={...s,...e},d=(0,b.o)("Checkbox",c),x=(0,i.M)(e),{spacing:p="0.5rem",className:j,children:_,iconColor:w,iconSize:T,icon:E=(0,r.jsx)(m,{}),isChecked:S,isDisabled:B=null==s?void 0:s.isDisabled,onChange:N,inputProps:R,...O}=x,I=S;(null==s?void 0:s.value)&&x.value&&(I=s.value.includes(x.value));let D=N;(null==s?void 0:s.onChange)&&x.value&&(D=(0,n.O)(s.onChange,N));let{state:A,getInputProps:L,getCheckboxProps:z,getLabelProps:M,getRootProps:W}=(0,f.v)({...O,isDisabled:B,isChecked:I,onChange:D}),U=function(e){let[t,s]=(0,o.useState)(e),[r,i]=(0,o.useState)(!1);return e!==t&&(i(!0),s(e)),r}(A.isChecked),X=(0,o.useMemo)(()=>({animation:U?A.isIndeterminate?"".concat(k," 20ms linear, ").concat(C," 200ms linear"):"".concat(g," 200ms linear"):void 0,...d.icon,...(0,a.o)({fontSize:T,color:w})}),[w,T,U,A.isIndeterminate,d.icon]),V=(0,o.cloneElement)(E,{__css:X,isIndeterminate:A.isIndeterminate,isChecked:A.isChecked});return(0,r.jsxs)(h.B.label,{__css:{...y,...d.container},className:(0,l.cx)("chakra-checkbox",j),...W(),children:[(0,r.jsx)("input",{className:"chakra-checkbox__input",...L(R,t)}),(0,r.jsx)(h.B.span,{__css:{...v,...d.control},className:"chakra-checkbox__control",...z(),children:V}),_&&(0,r.jsx)(h.B.span,{className:"chakra-checkbox__label",...M(),__css:{marginStart:p,...d.label},children:_})]})});_.displayName="Checkbox"},29286:(e,t,s)=>{"use strict";s.d(t,{AO:()=>l,tp:()=>a});var r=s(99628);let i=e=>e.hasAttribute("tabindex"),n=e=>i(e)&&-1===e.tabIndex;function a(e){if(!(0,r.sb)(e)||(0,r.N3)(e)||(0,r.pj)(e))return!1;let{localName:t}=e;if(["input","select","textarea","button"].indexOf(t)>=0)return!0;let s={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in s?s[t]():!!(0,r.wu)(e)||i(e)}function l(e){return!!e&&(0,r.sb)(e)&&a(e)&&!n(e)}},37824:(e,t,s)=>{"use strict";s.d(t,{X:()=>h,k:()=>u});var r=s(95155),i=s(78038),n=s(61214),a=s(92622),l=s(30044),c=s(17891),o=s(47415);let[d,u]=(0,n.q)({name:"TableStylesContext",errorMessage:"useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<Table />\" "}),h=(0,l.R)((e,t)=>{let s=(0,c.o)("Table",e),{className:n,layout:l,...u}=(0,i.M)(e);return(0,r.jsx)(d,{value:s,children:(0,r.jsx)(o.B.table,{ref:t,__css:{tableLayout:l,...s.table},className:(0,a.cx)("chakra-table",n),...u})})});h.displayName="Table"},39376:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});var r=s(95155),i=s(12115),n=s(77978);let a=(0,s(30044).R)((e,t)=>{let{icon:s,children:a,isRound:l,"aria-label":c,...o}=e,d=s||a,u=(0,i.isValidElement)(d)?(0,i.cloneElement)(d,{"aria-hidden":!0,focusable:!1}):null;return(0,r.jsx)(n.$,{px:"0",py:"0",borderRadius:l?"full":void 0,ref:t,"aria-label":c,...o,children:u})});a.displayName="IconButton"},47272:(e,t,s)=>{"use strict";s.d(t,{Tr:()=>l});var r=s(95155),i=s(37824),n=s(30044),a=s(47415);let l=(0,n.R)((e,t)=>{let s=(0,i.k)();return(0,r.jsx)(a.B.tr,{...e,ref:t,__css:s.tr})})},58727:(e,t,s)=>{"use strict";s.d(t,{z:()=>n});var r=s(95155),i=s(60078);let n=(0,s(30044).R)((e,t)=>(0,r.jsx)(i.B,{align:"center",...e,direction:"row",ref:t}));n.displayName="HStack"},66080:(e,t,s)=>{"use strict";s.d(t,{N:()=>l});var r=s(95155),i=s(37824),n=s(30044),a=s(47415);let l=(0,n.R)((e,t)=>{let s=(0,i.k)();return(0,r.jsx)(a.B.tbody,{...e,ref:t,__css:s.tbody})})},75569:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var r=s(95155),i=s(60078);let n=(0,s(30044).R)((e,t)=>(0,r.jsx)(i.B,{align:"center",...e,direction:"column",ref:t}));n.displayName="VStack"},76122:(e,t,s)=>{"use strict";s.d(t,{Th:()=>l});var r=s(95155),i=s(37824),n=s(30044),a=s(47415);let l=(0,n.R)((e,t)=>{let{isNumeric:s,...n}=e,l=(0,i.k)();return(0,r.jsx)(a.B.th,{...n,ref:t,__css:l.th,"data-is-numeric":s})})},76783:(e,t,s)=>{"use strict";function r(e,t){let s={},r={};for(let[i,n]of Object.entries(e))t.includes(i)?s[i]=n:r[i]=n;return[s,r]}s.d(t,{l:()=>r})},80436:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var r=s(95155),i=s(78038),n=s(92622),a=s(30044),l=s(17891),c=s(47415);let o=(0,a.R)(function(e,t){let s=(0,l.V)("Badge",e),{className:a,...o}=(0,i.M)(e);return(0,r.jsx)(c.B.span,{ref:t,className:(0,n.cx)("chakra-badge",e.className),...o,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...s}})});o.displayName="Badge"},83382:(e,t,s)=>{"use strict";s.d(t,{d:()=>l});var r=s(95155),i=s(37824),n=s(30044),a=s(47415);let l=(0,n.R)((e,t)=>{let s=(0,i.k)();return(0,r.jsx)(a.B.thead,{...e,ref:t,__css:s.thead})})},92424:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var r=s(95155),i=s(12115),n=s(23006),a=s(7098),l=s(77700),c=s(75569),o=s(58727),d=s(33636),u=s(4316),h=s(77978),x=s(37824),p=s(83382),m=s(47272),f=s(76122),j=s(26584),b=s(66080),v=s(24710),y=s(58670),g=s(80436),k=s(1996),C=s(831),_=s(39376),w=s(59771),T=s(82610),E=s(10351);function S(){let[e,t]=(0,i.useState)([]),[s,S]=(0,i.useState)([]),[B,N]=(0,i.useState)(!1),[R,O]=(0,i.useState)({keyword:"",status:"",storageType:"",sortBy:"uploadTime",sortOrder:"desc"}),I=(0,n.d)();(0,a.dU)("white","gray.800"),(0,a.dU)("gray.200","gray.600"),(0,i.useEffect)(()=>{D()},[R]);let D=async()=>{N(!0);try{let e=await fetch("/api/files?".concat(new URLSearchParams(R)));if(!e.ok)throw Error("获取文件列表失败");let s=await e.json();t(s)}catch(e){I({title:"获取文件列表失败",description:e instanceof Error?e.message:"未知错误",status:"error",duration:5e3,isClosable:!0})}finally{N(!1)}},A=e=>{O(t=>({...t,sortBy:e,sortOrder:t.sortBy===e&&"asc"===t.sortOrder?"desc":"asc"}))},L=e=>{S(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},z=async e=>{try{let t=await fetch("/api/files/".concat(e.id,"/download"));if(!t.ok)throw Error("下载失败");let s=await t.blob(),r=window.URL.createObjectURL(s),i=document.createElement("a");i.href=r,i.download=e.name,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(r),document.body.removeChild(i)}catch(e){I({title:"下载失败",description:e instanceof Error?e.message:"未知错误",status:"error",duration:5e3,isClosable:!0})}},M=async e=>{try{if(!(await fetch("/api/files/".concat(e),{method:"DELETE"})).ok)throw Error("删除失败");t(t=>t.filter(t=>t.id!==e)),I({title:"删除成功",status:"success",duration:3e3,isClosable:!0})}catch(e){I({title:"删除失败",description:e instanceof Error?e.message:"未知错误",status:"error",duration:5e3,isClosable:!0})}},W=async e=>{try{let t="".concat(window.location.origin,"/api/files/").concat(e.id,"/view");await navigator.clipboard.writeText(t),I({title:"链接已复制",description:"文件访问链接已复制到剪贴板",status:"success",duration:3e3,isClosable:!0})}catch(e){I({title:"复制失败",description:e instanceof Error?e.message:"复制链接失败",status:"error",duration:5e3,isClosable:!0})}},U=async()=>{if(!s.length){I({title:"请选择要删除的文件",status:"warning",duration:3e3,isClosable:!0});return}try{if(!(await fetch("/api/files/batch",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileIds:s})})).ok)throw Error("批量删除失败");t(e=>e.filter(e=>!s.includes(e.id))),S([]),I({title:"批量删除成功",status:"success",duration:3e3,isClosable:!0})}catch(e){I({title:"批量删除失败",description:e instanceof Error?e.message:"未知错误",status:"error",duration:5e3,isClosable:!0})}},X=e=>{switch(e){case"uploading":return"blue";case"completed":return"green";case"failed":return"red";default:return"gray"}};return(0,r.jsx)(l.a,{p:6,children:(0,r.jsxs)(c.T,{spacing:6,align:"stretch",children:[(0,r.jsxs)(o.z,{spacing:4,children:[(0,r.jsx)(d.p,{placeholder:"搜索文件名",value:R.keyword,onChange:e=>{O(t=>({...t,keyword:e.target.value}))},maxW:"300px"}),(0,r.jsxs)(u.l,{placeholder:"文件状态",value:R.status,onChange:e=>O(t=>({...t,status:e.target.value})),maxW:"200px",children:[(0,r.jsx)("option",{value:"uploading",children:"上传中"}),(0,r.jsx)("option",{value:"completed",children:"已完成"}),(0,r.jsx)("option",{value:"failed",children:"失败"}),(0,r.jsx)("option",{value:"deleted",children:"已删除"})]}),(0,r.jsxs)(u.l,{placeholder:"存储类型",value:R.storageType,onChange:e=>O(t=>({...t,storageType:e.target.value})),maxW:"200px",children:[(0,r.jsx)("option",{value:"local",children:"本地存储"}),(0,r.jsx)("option",{value:"oss",children:"阿里云OSS"}),(0,r.jsx)("option",{value:"cos",children:"腾讯云COS"}),(0,r.jsx)("option",{value:"s3",children:"AWS S3"})]}),(0,r.jsx)(h.$,{colorScheme:"red",onClick:U,isDisabled:!s.length,children:"批量删除"})]}),(0,r.jsx)(l.a,{overflowX:"auto",children:(0,r.jsxs)(x.X,{variant:"simple",children:[(0,r.jsx)(p.d,{children:(0,r.jsxs)(m.Tr,{children:[(0,r.jsx)(f.Th,{children:(0,r.jsx)(j.S,{isChecked:s.length===e.length,onChange:t=>{t.target.checked?S(e.map(e=>e.id)):S([])}})}),(0,r.jsx)(f.Th,{cursor:"pointer",onClick:()=>A("name"),children:"文件名"}),(0,r.jsx)(f.Th,{cursor:"pointer",onClick:()=>A("size"),children:"大小"}),(0,r.jsx)(f.Th,{cursor:"pointer",onClick:()=>A("storageType"),children:"存储类型"}),(0,r.jsx)(f.Th,{children:"Bucket"}),(0,r.jsx)(f.Th,{cursor:"pointer",onClick:()=>A("status"),children:"状态"}),(0,r.jsx)(f.Th,{cursor:"pointer",onClick:()=>A("uploadTime"),children:"上传时间"}),(0,r.jsx)(f.Th,{children:"操作"})]})}),(0,r.jsx)(b.N,{children:e.map(e=>(0,r.jsxs)(m.Tr,{children:[(0,r.jsx)(v.Td,{children:(0,r.jsx)(j.S,{isChecked:s.includes(e.id),onChange:()=>L(e.id)})}),(0,r.jsx)(v.Td,{children:(0,r.jsx)(y.E,{noOfLines:1,maxW:"200px",children:e.name})}),(0,r.jsxs)(v.Td,{children:[(e.size/1024/1024).toFixed(2)," MB"]}),(0,r.jsx)(v.Td,{children:e.storageType}),(0,r.jsx)(v.Td,{children:e.bucket||"-"}),(0,r.jsx)(v.Td,{children:(0,r.jsx)(g.E,{colorScheme:X(e.status),children:e.status})}),(0,r.jsx)(v.Td,{children:new Date(e.uploadTime).toLocaleString()}),(0,r.jsx)(v.Td,{children:(0,r.jsxs)(k.W,{children:[(0,r.jsx)(C.I,{as:_.K,icon:(0,r.jsx)(E.ZZB,{}),variant:"ghost",size:"sm"}),(0,r.jsxs)(w.c,{children:[(0,r.jsx)(T.D,{icon:(0,r.jsx)(E.a4x,{}),onClick:()=>z(e),isDisabled:"completed"!==e.status,children:"下载"}),(0,r.jsx)(T.D,{icon:(0,r.jsx)(E.ayE,{}),onClick:()=>W(e),isDisabled:"completed"!==e.status,children:"复制链接"}),(0,r.jsx)(T.D,{icon:(0,r.jsx)(E.IXo,{}),onClick:()=>M(e.id),color:"red.500",children:"删除"})]})]})})]},e.id))})]})})]})})}},99628:(e,t,s)=>{"use strict";function r(e){return null!=e&&"object"==typeof e&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function i(){return!!globalThis?.document}function n(e){let t=e.getAttribute("contenteditable");return"false"!==t&&null!=t}function a(e){return!0==!!e.getAttribute("disabled")||!0==!!e.getAttribute("aria-disabled")}s.d(t,{Bd:()=>i,N3:()=>function e(t){return!!(t.parentElement&&e(t.parentElement))||t.hidden},pj:()=>a,sb:()=>r,wu:()=>n})}},e=>{var t=t=>e(e.s=t);e.O(0,[844,8791,6829,6980,7039,2210,8277,6654,8815,8441,1684,7358],()=>t(12210)),_N_E=e.O()}]);