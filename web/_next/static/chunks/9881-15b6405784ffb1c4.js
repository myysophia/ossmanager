"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9881],{59881:(e,s,l)=>{l.d(s,{Ih:()=>eg});var i=l(95155),n=l(12115),t=l(52017),r=l(7098),o=l(23006),a=l(77700),c=l(75569),d=l(59108),x=l(58727),h=l(77978),u=l(92998),j=l(37492),p=l(99785),g=l(39376),m=l(10351),f=l(3740),b=l(15932),C=l(93687),y=l(79251),v=l(943);let z=e=>{let{items:s,onNavigate:l,onRefresh:t,isRefreshing:o=!1,showUpButton:c=!0,maxItems:x=5}=e,h=(0,r.dU)("white","gray.800"),u=(0,r.dU)("gray.200","gray.600"),j=n.useMemo(()=>s.length<=x?s:[s[0],{name:"...",path:"",isEllipsis:!0},...s.slice(-x+2)],[s,x]);return(0,i.jsx)(a.a,{bg:h,borderBottom:"1px",borderColor:u,px:4,py:3,position:"sticky",top:0,zIndex:10,children:(0,i.jsxs)(d.s,{align:"center",gap:2,children:[(0,i.jsx)(p.m,{label:"回到根目录",children:(0,i.jsx)(g.K,{"aria-label":"回到根目录",icon:(0,i.jsx)(f.I,{as:m.V5Y}),size:"sm",variant:"ghost",onClick:()=>l("/")})}),c&&s.length>1&&(0,i.jsx)(p.m,{label:"上级目录",children:(0,i.jsx)(g.K,{"aria-label":"上级目录",icon:(0,i.jsx)(f.I,{as:m.ei4}),size:"sm",variant:"ghost",onClick:()=>{s.length>1&&l(s[s.length-2].path)}})}),(0,i.jsx)(b.Q,{spacing:"8px",separator:(0,i.jsx)(v.v,{color:"gray.400"}),flex:1,children:j.map((e,s)=>{let n=s===j.length-1,t="isEllipsis"in e&&e.isEllipsis;return(0,i.jsx)(C.J,{isCurrentPage:n,children:t?(0,i.jsx)(a.a,{color:"gray.400",fontSize:"sm",children:"..."}):n?(0,i.jsx)(a.a,{color:"gray.600",fontWeight:"medium",maxWidth:"200px",isTruncated:!0,children:e.name||"根目录"}):(0,i.jsx)(y.w,{onClick:()=>l(e.path),_hover:{color:"blue.500"},maxWidth:"150px",isTruncated:!0,children:e.name||"根目录"})},"".concat(e.path,"-").concat(s))})}),t&&(0,i.jsx)(p.m,{label:"刷新",children:(0,i.jsx)(g.K,{"aria-label":"刷新",icon:(0,i.jsx)(f.I,{as:m.jTZ,transform:o?"rotate(360deg)":"none",transition:"transform 1s ease-in-out"}),size:"sm",variant:"ghost",onClick:t,isDisabled:o})})]})})};var k=l(47995),S=l(76122),w=l(1996),D=l(831),T=l(59771),M=l(82610),I=l(28840),O=l(84492),E=l(58670),L=l(60078),U=l(29826),P=l(24369),W=l(26584),F=l(37824),B=l(83382),N=l(47272),R=l(66080),$=l(24710),K=l(80436),Z=l(11930),_=l(13073);let X=e=>{var s,l;if("folder"===e.type)return m.UDU;let i=null===(s=e.name.split(".").pop())||void 0===s?void 0:s.toLowerCase(),n=(null===(l=e.mimeType)||void 0===l?void 0:l.toLowerCase())||"";return n.startsWith("image/")||["jpg","jpeg","png","gif","svg","webp"].includes(i||"")?m.fZZ:n.startsWith("video/")||["mp4","avi","mkv","mov","wmv"].includes(i||"")?m.pVQ:n.startsWith("audio/")||["mp3","wav","flac","aac","m4a"].includes(i||"")?m.$Mw:["zip","rar","7z","tar","gz"].includes(i||"")?m.OZ2:["txt","md","doc","docx","pdf"].includes(i||"")?m.jH2:["js","ts","jsx","tsx","html","css","json","xml","py","java","cpp"].includes(i||"")?m.PjK:m.QuH},A=e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,s)).toFixed(1))," ").concat(["B","KB","MB","GB","TB"][s])},Q=e=>{let s=Math.floor((new Date().getTime()-e.getTime())/864e5);return 0===s?e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):s<7?"".concat(s,"天前"):e.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})},G=e=>{let{items:s,selectedItems:l,isLoading:t=!1,allowMultiSelect:o=!1,sortConfig:c,contextMenuItems:h=[],onItemSelect:u,onItemDoubleClick:j,onSort:p,onContextMenu:b}=e;(0,r.dU)("gray.200","gray.600");let C=(0,r.dU)("gray.50","gray.700"),y=(0,r.dU)("blue.50","blue.900"),v=(0,k.A)({base:!0,md:!1}),z=n.useMemo(()=>[...s].sort((e,s)=>{if("folder"===e.type&&"file"===s.type)return -1;if("file"===e.type&&"folder"===s.type)return 1;if(c){let l=e[c.key],i=s[c.key];if(l instanceof Date&&i instanceof Date&&(l=l.getTime(),i=i.getTime()),"string"==typeof l&&"string"==typeof i&&(l=l.toLowerCase(),i=i.toLowerCase()),l<i)return"asc"===c.direction?-1:1;if(l>i)return"asc"===c.direction?1:-1}return 0}),[s,c]),G=(e,s)=>{if(s.preventDefault(),o&&u){let s=l.includes(e.id);u(e.id,!s)}},H=e=>{j&&j(e)},V=(e,s)=>(0,i.jsx)(S.Th,{cursor:p?"pointer":"default",onClick:()=>p&&p(s),_hover:p?{bg:C}:void 0,children:(0,i.jsxs)(d.s,{align:"center",gap:1,children:[e,(null==c?void 0:c.key)===s&&(0,i.jsx)(f.I,{as:"asc"===c.direction?Z.M:_.D,boxSize:3})]})}),Y=e=>(0,i.jsxs)(w.W,{children:[(0,i.jsx)(D.I,{as:g.K,icon:(0,i.jsx)(f.I,{as:m.ZZB}),size:"sm",variant:"ghost","aria-label":"更多操作"}),(0,i.jsxs)(T.c,{children:[(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.a4x}),children:"下载"}),(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.WXf}),children:"重命名"}),(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.Pum}),children:"分享"}),(0,i.jsx)(I.N,{}),(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.IXo}),color:"red.500",children:"删除"})]})]});return t?(0,i.jsx)(d.s,{justify:"center",align:"center",h:"200px",children:(0,i.jsx)(O.y,{size:"lg"})}):0===s.length?(0,i.jsxs)(d.s,{justify:"center",align:"center",h:"200px",direction:"column",children:[(0,i.jsx)(f.I,{as:m.UDU,boxSize:12,color:"gray.400",mb:4}),(0,i.jsx)(E.E,{color:"gray.500",children:"此文件夹为空"})]}):v?(0,i.jsx)(L.B,{spacing:2,p:4,children:z.map(e=>{let s=l.includes(e.id),n=X(e);return(0,i.jsx)(U.Z,{cursor:"pointer",bg:s?y:void 0,_hover:{bg:C},onClick:s=>G(e,s),onDoubleClick:()=>H(e),children:(0,i.jsx)(P.b,{p:3,children:(0,i.jsxs)(d.s,{align:"center",gap:3,children:[o&&(0,i.jsx)(W.S,{isChecked:s,onChange:s=>u&&u(e.id,s.target.checked)}),(0,i.jsx)(f.I,{as:n,boxSize:5,color:"folder"===e.type?"blue.500":"gray.500"}),(0,i.jsxs)(a.a,{flex:1,minW:0,children:[(0,i.jsx)(E.E,{fontWeight:"medium",isTruncated:!0,children:e.name}),(0,i.jsxs)(x.z,{spacing:2,fontSize:"sm",color:"gray.500",children:["file"===e.type&&(0,i.jsx)(E.E,{children:A(e.size)}),(0,i.jsx)(E.E,{children:Q(e.lastModified)})]})]}),Y(e)]})})},e.id)})}):(0,i.jsx)(a.a,{overflowX:"auto",children:(0,i.jsxs)(F.X,{variant:"simple",size:"sm",children:[(0,i.jsx)(B.d,{children:(0,i.jsxs)(N.Tr,{children:[o&&(0,i.jsx)(S.Th,{w:"50px",children:(0,i.jsx)(W.S,{isChecked:l.length===s.length&&s.length>0,isIndeterminate:l.length>0&&l.length<s.length,onChange:e=>{u&&s.forEach(s=>{u(s.id,e.target.checked)})}})}),V("名称","name"),V("大小","size"),V("修改时间","lastModified"),(0,i.jsx)(S.Th,{w:"60px",children:"操作"})]})}),(0,i.jsx)(R.N,{children:z.map(e=>{let s=l.includes(e.id),n=X(e);return(0,i.jsxs)(N.Tr,{cursor:"pointer",bg:s?y:void 0,_hover:{bg:C},onClick:s=>G(e,s),onDoubleClick:()=>H(e),children:[o&&(0,i.jsx)($.Td,{children:(0,i.jsx)(W.S,{isChecked:s,onChange:s=>u&&u(e.id,s.target.checked)})}),(0,i.jsx)($.Td,{children:(0,i.jsxs)(x.z,{spacing:3,children:[(0,i.jsx)(f.I,{as:n,boxSize:4,color:"folder"===e.type?"blue.500":"gray.500"}),(0,i.jsx)(E.E,{isTruncated:!0,maxW:"300px",title:e.name,children:e.name}),e.isLoading&&(0,i.jsx)(O.y,{size:"xs"})]})}),(0,i.jsx)($.Td,{children:"file"===e.type?(0,i.jsx)(E.E,{fontSize:"sm",color:"gray.600",children:A(e.size)}):(0,i.jsx)(K.E,{colorScheme:"blue",variant:"subtle",size:"sm",children:"文件夹"})}),(0,i.jsx)($.Td,{children:(0,i.jsx)(E.E,{fontSize:"sm",color:"gray.600",children:Q(e.lastModified)})}),(0,i.jsx)($.Td,{children:Y(e)})]},e.id)})})]})})};var H=l(86697),V=l(79788),Y=l(21688),J=l(83677),q=l(41046);let ee=e=>{let{currentPath:s,uploads:l,disabled:t=!1,accept:o,maxSize:u=0x6400000,maxFiles:j=10,multiple:b=!0,showDropzone:C=!0,onUpload:y,onCancelUpload:v,onRetryUpload:z,onClearCompleted:k}=e,[S,w]=(0,n.useState)(!1),D=(0,r.dU)("gray.300","gray.600"),T=(0,r.dU)("blue.400","blue.300"),M=(0,r.dU)("gray.50","gray.700"),I=(0,r.dU)("blue.50","blue.900"),O=(0,n.useCallback)((e,s)=>{w(!1),s.length>0&&console.warn("Some files were rejected:",s),e.length>0&&y(e)},[y]),{getRootProps:W,getInputProps:F,isDragActive:B,isDragAccept:N,isDragReject:R,open:$}=(0,q.VB)({onDrop:O,accept:o,maxSize:u,maxFiles:j,multiple:b,disabled:t,onDragEnter:()=>w(!0),onDragLeave:()=>w(!1)}),Z=e=>{if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,s)).toFixed(1))," ").concat(["B","KB","MB","GB"][s])},_=n.useMemo(()=>{let e=l.length,s=l.filter(e=>"completed"===e.status).length,i=l.filter(e=>"failed"===e.status).length;return{total:e,completed:s,failed:i,uploading:l.filter(e=>"uploading"===e.status).length,cancelled:l.filter(e=>"cancelled"===e.status).length}},[l]);return(0,i.jsxs)(a.a,{children:[C&&(0,i.jsxs)(a.a,{...W(),border:"2px dashed",borderColor:B?N?T:"red.400":D,bg:B?N?I:"red.50":M,borderRadius:"lg",p:8,textAlign:"center",cursor:t?"not-allowed":"pointer",transition:"all 0.2s",_hover:t?void 0:{borderColor:T,bg:I},children:[(0,i.jsx)("input",{...F()}),(0,i.jsxs)(c.T,{spacing:4,children:[(0,i.jsx)(f.I,{as:m.B88,boxSize:12,color:B?N?"blue.500":"red.500":"gray.400"}),(0,i.jsxs)(c.T,{spacing:1,children:[(0,i.jsx)(E.E,{fontSize:"lg",fontWeight:"medium",children:B?N?"释放文件以上传":"不支持的文件类型":"拖拽文件到这里或点击选择"}),(0,i.jsxs)(E.E,{fontSize:"sm",color:"gray.500",children:["支持最大 ",Z(u)," 的文件",j>1&&"，最多 ".concat(j," 个文件")]})]}),(0,i.jsx)(h.$,{colorScheme:"blue",variant:"outline",leftIcon:(0,i.jsx)(f.I,{as:m.B88}),onClick:$,isDisabled:t,children:"选择文件"})]})]}),!C&&(0,i.jsx)(h.$,{leftIcon:(0,i.jsx)(f.I,{as:m.B88}),colorScheme:"blue",onClick:$,isDisabled:t,size:"sm",children:"上传"}),l.length>0&&(0,i.jsxs)(a.a,{mt:4,children:[(0,i.jsxs)(d.s,{justify:"space-between",align:"center",mb:3,children:[(0,i.jsxs)(x.z,{spacing:2,children:[(0,i.jsx)(E.E,{fontSize:"sm",fontWeight:"medium",children:"上传进度"}),_.total>0&&(0,i.jsxs)(K.E,{variant:"outline",children:[_.completed,"/",_.total]})]}),_.completed>0&&k&&(0,i.jsx)(h.$,{size:"xs",variant:"ghost",onClick:k,children:"清除已完成"})]}),_.total>0&&(0,i.jsxs)(x.z,{spacing:4,mb:3,fontSize:"xs",color:"gray.600",children:[_.uploading>0&&(0,i.jsxs)(E.E,{children:["上传中: ",_.uploading]}),_.completed>0&&(0,i.jsxs)(E.E,{color:"green.600",children:["完成: ",_.completed]}),_.failed>0&&(0,i.jsxs)(E.E,{color:"red.600",children:["失败: ",_.failed]}),_.cancelled>0&&(0,i.jsxs)(E.E,{color:"gray.500",children:["取消: ",_.cancelled]})]}),(0,i.jsx)(L.B,{spacing:2,maxH:"300px",overflowY:"auto",children:l.map(e=>{let s=()=>{switch(e.status){case"completed":return"green";case"failed":return"red";case"cancelled":return"gray";default:return"blue"}};return(0,i.jsx)(U.Z,{size:"sm",mb:2,children:(0,i.jsxs)(P.b,{p:3,children:[(0,i.jsxs)(d.s,{align:"center",gap:3,children:[(0,i.jsx)(f.I,{as:(()=>{switch(e.status){case"completed":return m.YrT;case"failed":return m.y3G;default:return m.QuH}})(),color:"".concat(s(),".500"),boxSize:4}),(0,i.jsxs)(a.a,{flex:1,minW:0,children:[(0,i.jsx)(E.E,{fontSize:"sm",fontWeight:"medium",isTruncated:!0,children:e.file.name}),(0,i.jsx)(E.E,{fontSize:"xs",color:"gray.500",children:Z(e.file.size)})]}),(0,i.jsxs)(c.T,{spacing:1,align:"end",minW:"80px",children:[(0,i.jsxs)(K.E,{colorScheme:s(),variant:"subtle",fontSize:"xs",children:["uploading"===e.status&&"".concat(Math.round(e.progress),"%"),"completed"===e.status&&"完成","failed"===e.status&&"失败","cancelled"===e.status&&"取消"]}),"uploading"===e.status&&(0,i.jsx)(H.k,{value:e.progress,size:"sm",colorScheme:"blue",width:"60px"})]}),(0,i.jsxs)(x.z,{spacing:1,children:["failed"===e.status&&z&&(0,i.jsx)(p.m,{label:"重试",children:(0,i.jsx)(g.K,{"aria-label":"重试",icon:(0,i.jsx)(f.I,{as:m.B88}),size:"xs",variant:"ghost",onClick:()=>z(e.id)})}),("uploading"===e.status||"failed"===e.status)&&v&&(0,i.jsx)(p.m,{label:"取消",children:(0,i.jsx)(g.K,{"aria-label":"取消",icon:(0,i.jsx)(f.I,{as:m.yGN}),size:"xs",variant:"ghost",colorScheme:"red",onClick:()=>v(e.id)})})]})]}),"failed"===e.status&&e.error&&(0,i.jsxs)(V.F,{status:"error",size:"sm",mt:2,children:[(0,i.jsx)(Y._,{boxSize:3}),(0,i.jsx)(J.T,{fontSize:"xs",children:e.error})]})]})},e.id)})})]})]})};var es=l(64982),el=l(64346);let ei=e=>{let{selectedItems:s,position:l,isOpen:n,customItems:t=[],enabledActions:r={download:!0,rename:!0,delete:!0,share:!0,copy:!0,move:!0,preview:!0,properties:!0,newFolder:!0,refresh:!0},onClose:o,onDownload:c,onRename:d,onDelete:x,onShare:h,onCopy:u,onMove:j,onPreview:p,onProperties:g,onNewFolder:b,onRefresh:C}=e,y=s.length>0,v=1===s.length,z=v?s[0]:null;s.some(e=>"file"===e.type),s.some(e=>"folder"===e.type);let k=s.length>1,S=e=>{e.action(),o()};return n?(0,i.jsx)(es.Z,{children:(0,i.jsx)(a.a,{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,onClick:o,children:(0,i.jsxs)(w.W,{isOpen:n,onClose:o,children:[(0,i.jsx)(D.I,{position:"absolute",left:(null==l?void 0:l.x)||0,top:(null==l?void 0:l.y)||0,w:"1px",h:"1px",opacity:0,pointerEvents:"none"}),(0,i.jsxs)(T.c,{position:"absolute",left:(null==l?void 0:l.x)||0,top:(null==l?void 0:l.y)||0,zIndex:1e4,minW:"180px",children:[y&&(0,i.jsxs)(el.r,{title:"".concat(s.length," 项已选择"),children:[r.preview&&v&&(null==z?void 0:z.type)==="file"&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.Vap}),onClick:()=>{p&&z&&p(z),o()},children:"预览"}),r.download&&c&&(0,i.jsxs)(M.D,{icon:(0,i.jsx)(f.I,{as:m.a4x}),onClick:()=>{c&&y&&c(s),o()},children:["下载 ",k?"(".concat(s.length,"项)"):""]}),r.rename&&v&&d&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.WXf}),onClick:()=>{d&&z&&d(z),o()},children:"重命名"}),r.copy&&u&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.nxz}),onClick:()=>{u&&y&&u(s),o()},children:"复制"}),r.move&&j&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.PfQ}),onClick:()=>{j&&y&&j(s),o()},children:"移动"}),r.share&&h&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.Pum}),onClick:()=>{h&&y&&h(s),o()},children:"分享"}),r.properties&&v&&g&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.S8s}),onClick:()=>{g&&z&&g(z),o()},children:"属性"}),(0,i.jsx)(I.N,{}),r.delete&&x&&(0,i.jsxs)(M.D,{icon:(0,i.jsx)(f.I,{as:m.IXo}),color:"red.500",onClick:()=>{x&&y&&x(s),o()},children:["删除 ",k?"(".concat(s.length,"项)"):""]})]}),(!y||t.length>0)&&(0,i.jsxs)(i.Fragment,{children:[y&&(0,i.jsx)(I.N,{}),(0,i.jsxs)(el.r,{title:"文件夹操作",children:[r.newFolder&&b&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.UDU}),onClick:()=>{b&&b(),o()},children:"新建文件夹"}),r.refresh&&C&&(0,i.jsx)(M.D,{icon:(0,i.jsx)(f.I,{as:m.jTZ}),onClick:()=>{C&&C(),o()},children:"刷新"})]})]}),t.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(I.N,{}),(0,i.jsx)(el.r,{title:"更多操作",children:t.map(e=>(0,i.jsx)(M.D,{icon:e.icon?(0,i.jsx)(f.I,{as:e.icon}):void 0,onClick:()=>S(e),isDisabled:e.disabled,color:e.isDanger?"red.500":void 0,children:e.label},e.id))})]})]})]})})}):null};var en=l(25442),et=l(64688),er=l(61549),eo=l(27104),ea=l(5643),ec=l(26418),ed=l(79175),ex=l(33636),eh=l(52019),eu=l(49174);let ej=e=>{let{isOpen:s,item:l,isLoading:t=!1,onClose:r,onRename:a}=e,[c,d]=(0,n.useState)(""),[u,j]=(0,n.useState)(""),[p,g]=(0,n.useState)(!1),b=(0,n.useRef)(null),C=(0,o.d)();(0,n.useEffect)(()=>{s&&l&&(d(l.name),j(""),g(!1),setTimeout(()=>{if(b.current){if(b.current.focus(),"file"===l.type){let e=l.name.lastIndexOf(".");e>0?b.current.setSelectionRange(0,e):b.current.select()}else b.current.select()}},100))},[s,l]);let y=e=>e.trim()?e.trim()===(null==l?void 0:l.name)?"名称未更改":/[<>:"/\\|?*\x00-\x1f]/g.test(e)?'名称不能包含以下字符: < > : " / \\ | ? *':["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"].includes(e.split(".")[0].toUpperCase())?"不能使用保留名称":e.length>255?"名称长度不能超过 255 个字符":"":"名称不能为空",v=async e=>{if(e.preventDefault(),!l)return;let s=c.trim(),i=y(s);if(i){j(i);return}g(!0),j("");try{await a(l,s),C({title:"重命名成功",description:'"'.concat(l.name,'" 已重命名为 "').concat(s,'"'),status:"success",duration:3e3,isClosable:!0}),r()}catch(s){let e=s.message||"重命名失败，请重试";j(e),C({title:"重命名失败",description:e,status:"error",duration:5e3,isClosable:!0})}finally{g(!1)}},z=()=>{p||r()};return l?(0,i.jsxs)(en.aF,{isOpen:s,onClose:z,size:"md",closeOnOverlayClick:!p,closeOnEsc:!p,children:[(0,i.jsx)(et.m,{}),(0,i.jsx)(er.$,{children:(0,i.jsxs)("form",{onSubmit:v,children:[(0,i.jsx)(eo.r,{children:(0,i.jsxs)(x.z,{spacing:2,children:[(0,i.jsx)(f.I,{as:"folder"===l.type?m.UDU:m.QuH,color:"folder"===l.type?"blue.500":"gray.500"}),(0,i.jsxs)(E.E,{children:["重命名","folder"===l.type?"文件夹":"文件"]})]})}),(0,i.jsx)(ea.c,{children:(0,i.jsxs)(ec.MJ,{isInvalid:!!u,children:[(0,i.jsx)(ed.l,{children:"新名称"}),(0,i.jsx)(ex.p,{ref:b,value:c,onChange:e=>{d(e.target.value),u&&j("")},placeholder:"输入新名称",isDisabled:p||t,autoComplete:"off"}),(0,i.jsx)(eh.Wt,{children:u})]})}),(0,i.jsx)(eu.j,{children:(0,i.jsxs)(x.z,{spacing:3,children:[(0,i.jsx)(h.$,{variant:"ghost",onClick:z,isDisabled:p||t,children:"取消"}),(0,i.jsx)(h.$,{type:"submit",colorScheme:"blue",isLoading:p||t,loadingText:"重命名中...",isDisabled:!c.trim()||c.trim()===l.name,children:"重命名"})]})})]})})]}):null},ep=e=>{let{isOpen:s,currentPath:l,isLoading:t=!1,existingNames:r=[],onClose:a,onCreateFolder:c}=e,[d,u]=(0,n.useState)(""),[j,p]=(0,n.useState)(""),[g,b]=(0,n.useState)(!1),C=(0,n.useRef)(null),y=(0,o.d)();(0,n.useEffect)(()=>{s&&(u(""),p(""),b(!1),setTimeout(()=>{C.current&&C.current.focus()},100))},[s]);let v=e=>e.trim()?/[<>:"/\\|?*\x00-\x1f]/g.test(e)?'文件夹名称不能包含以下字符: < > : " / \\ | ? *':["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"].includes(e.toUpperCase())?"不能使用保留名称":r.some(s=>s.toLowerCase()===e.toLowerCase())?"该名称已存在":e.length>255?"文件夹名称长度不能超过 255 个字符":e.startsWith(".")||e.startsWith(" ")||e.endsWith(" ")?"文件夹名称不能以点号或空格开头/结尾":"":"文件夹名称不能为空",z=async e=>{e.preventDefault();let s=d.trim(),i=v(s);if(i){p(i);return}b(!0),p("");try{await c(l,s),y({title:"创建成功",description:'文件夹 "'.concat(s,'" 已创建'),status:"success",duration:3e3,isClosable:!0}),a()}catch(s){let e=s.message||"创建文件夹失败，请重试";p(e),y({title:"创建失败",description:e,status:"error",duration:5e3,isClosable:!0})}finally{b(!1)}},k=()=>{g||a()};return(0,i.jsxs)(en.aF,{isOpen:s,onClose:k,size:"md",closeOnOverlayClick:!g,closeOnEsc:!g,children:[(0,i.jsx)(et.m,{}),(0,i.jsx)(er.$,{children:(0,i.jsxs)("form",{onSubmit:z,children:[(0,i.jsx)(eo.r,{children:(0,i.jsxs)(x.z,{spacing:2,children:[(0,i.jsx)(f.I,{as:m.UDU,color:"blue.500"}),(0,i.jsx)(E.E,{children:"新建文件夹"})]})}),(0,i.jsxs)(ea.c,{children:[(0,i.jsxs)(ec.MJ,{isInvalid:!!j,children:[(0,i.jsx)(ed.l,{children:"文件夹名称"}),(0,i.jsx)(ex.p,{ref:C,value:d,onChange:e=>{u(e.target.value),j&&p("")},placeholder:"输入文件夹名称",isDisabled:g||t,autoComplete:"off"}),(0,i.jsx)(eh.Wt,{children:j})]}),(0,i.jsxs)(E.E,{fontSize:"sm",color:"gray.500",mt:2,children:["将在当前路径下创建: ",l]})]}),(0,i.jsx)(eu.j,{children:(0,i.jsxs)(x.z,{spacing:3,children:[(0,i.jsx)(h.$,{variant:"ghost",onClick:k,isDisabled:g||t,children:"取消"}),(0,i.jsx)(h.$,{type:"submit",colorScheme:"blue",isLoading:g||t,loadingText:"创建中...",isDisabled:!d.trim(),children:"创建"})]})})]})})]})},eg=e=>{let{currentPath:s,items:l,breadcrumbs:f,uploads:b=[],config:C={},isLoading:y=!1,isRefreshing:v=!1,viewMode:k="list",actions:S}=e,[w,D]=(0,n.useState)([]),[T,M]=(0,n.useState)({key:"name",direction:"asc"}),[I,O]=(0,n.useState)(k),[E,L]=(0,n.useState)({isOpen:!1,position:{x:0,y:0},items:[]}),[U,P]=(0,n.useState)(!0),[W,F]=(0,n.useState)(null),B=(0,t.j)(),N=(0,t.j)(),R=(0,r.dU)("white","gray.800"),$=(0,r.dU)("gray.200","gray.600");(0,o.d)();let K={allowMultiSelect:!0,showHiddenFiles:!1,allowedFileTypes:void 0,maxFileSize:0x6400000,maxConcurrentUploads:5,enableDragAndDrop:!0,enableContextMenu:!0,...C};(0,n.useEffect)(()=>{D([])},[s]);let Z=(0,n.useCallback)((e,s)=>{D(l=>s?K.allowMultiSelect?[...l,e]:[e]:l.filter(s=>s!==e))},[K.allowMultiSelect]),_=(0,n.useCallback)(e=>{"folder"===e.type?S.onFolderDoubleClick(e):S.onFileDoubleClick(e)},[S]),X=(0,n.useCallback)(e=>{M(s=>({key:e,direction:s.key===e&&"asc"===s.direction?"desc":"asc"}))},[]),A=(0,n.useCallback)((e,s)=>{if(!K.enableContextMenu)return;e.preventDefault();let i=l.filter(e=>w.includes(e.id));L({isOpen:!0,position:{x:e.clientX,y:e.clientY},items:s?[s]:i})},[K.enableContextMenu,l,w]),Q=(0,n.useCallback)(e=>{F(e),B.onOpen()},[B]),H=(0,n.useCallback)(async(e,s)=>{await S.onRename(e,s),S.onRefresh()},[S]),V=(0,n.useCallback)(e=>{S.onDelete(e),D([])},[S]),Y=(0,n.useCallback)(()=>{N.onOpen()},[N]),J=(0,n.useCallback)(async(e,s)=>{await S.onCreateFolder(e,s),S.onRefresh()},[S]),q=(0,n.useCallback)(e=>{S.onUpload(e,s)},[S,s]),es=l.filter(e=>w.includes(e.id)),el=l.map(e=>e.name);return(0,i.jsxs)(a.a,{bg:R,borderRadius:"lg",border:"1px",borderColor:$,overflow:"hidden",children:[(0,i.jsxs)(c.T,{spacing:0,align:"stretch",children:[(0,i.jsx)(z,{items:f,onNavigate:S.onNavigate,onRefresh:S.onRefresh,isRefreshing:v}),(0,i.jsxs)(d.s,{px:4,py:2,borderBottom:"1px",borderColor:$,align:"center",gap:2,children:[(0,i.jsxs)(x.z,{spacing:2,children:[(0,i.jsx)(h.$,{size:"sm",leftIcon:(0,i.jsx)(m.GGD,{}),onClick:Y,variant:"outline",children:"新建文件夹"}),(0,i.jsx)(ee,{currentPath:s,uploads:b,onUpload:q,showDropzone:!1,maxSize:K.maxFileSize,multiple:K.allowMultiSelect}),w.length>0&&(0,i.jsxs)(h.$,{size:"sm",colorScheme:"red",variant:"outline",onClick:()=>V(es),children:["删除 (",w.length,")"]})]}),(0,i.jsx)(u.h,{}),(0,i.jsxs)(x.z,{spacing:2,children:[(0,i.jsxs)(j.e,{size:"sm",isAttached:!0,variant:"outline",children:[(0,i.jsx)(p.m,{label:"列表视图",children:(0,i.jsx)(g.K,{"aria-label":"列表视图",icon:(0,i.jsx)(m.Wm,{}),isActive:"list"===I,onClick:()=>O("list")})}),(0,i.jsx)(p.m,{label:"网格视图",children:(0,i.jsx)(g.K,{"aria-label":"网格视图",icon:(0,i.jsx)(m.QPV,{}),isActive:"grid"===I,onClick:()=>O("grid")})})]}),(0,i.jsx)(p.m,{label:"设置",children:(0,i.jsx)(g.K,{"aria-label":"设置",icon:(0,i.jsx)(m.VSk,{}),size:"sm",variant:"ghost"})}),(0,i.jsx)(p.m,{label:U?"隐藏上传区域":"显示上传区域",children:(0,i.jsx)(h.$,{size:"sm",variant:"ghost",onClick:()=>P(!U),children:U?"隐藏上传":"显示上传"})})]})]}),U&&(0,i.jsx)(a.a,{p:4,borderBottom:"1px",borderColor:$,children:(0,i.jsx)(ee,{currentPath:s,uploads:b,onUpload:q,showDropzone:!0,maxSize:K.maxFileSize,multiple:K.allowMultiSelect,accept:K.allowedFileTypes?Object.fromEntries(K.allowedFileTypes.map(e=>[e,[]])):void 0})}),(0,i.jsx)(a.a,{flex:1,onContextMenu:e=>A(e),children:(0,i.jsx)(G,{items:l,selectedItems:w,isLoading:y,allowMultiSelect:K.allowMultiSelect,sortConfig:T,onItemSelect:Z,onItemDoubleClick:_,onSort:X})})]}),(0,i.jsx)(ei,{isOpen:E.isOpen,selectedItems:E.items,position:E.position,onClose:()=>L(e=>({...e,isOpen:!1})),onDownload:S.onDownload,onRename:Q,onDelete:V,onNewFolder:Y,onRefresh:S.onRefresh}),(0,i.jsx)(ej,{isOpen:B.isOpen,item:W,onClose:()=>{B.onClose(),F(null)},onRename:H}),(0,i.jsx)(ep,{isOpen:N.isOpen,currentPath:s,existingNames:el,onClose:N.onClose,onCreateFolder:J})]})}}}]);